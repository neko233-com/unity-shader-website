<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compute Shader - Unity URP 2022 LTS æ•™ç¨‹</title>
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1>URP æ•™ç¨‹</h1>
            </div>
            <nav class="nav-menu" id="navMenu">
                <div class="nav-section">
                    <h3">âš™ï¸ é«˜çº§ä¸»é¢˜</h3>
                    <ul>
                        <li><a href="shader-variants.html">Shader å˜ä½“</a></li>
                        <li><a href="compute-shader.html" class="active">Compute Shader</a></li>
                        <li><a href="custom-render-pass.html">è‡ªå®šä¹‰æ¸²æŸ“ Pass</a></li>
                        <li><a href="performance-optimization.html">æ€§èƒ½ä¼˜åŒ–</a></li>
                    </ul>
                </div>
            </nav>
        </aside>

        <main class="main-content">
            <div class="function-page">
                <h1">Compute Shader</h1>
                <p class="subtitle">GPU é€šç”¨è®¡ç®—</p>

                <div class="section">
                    <h2">ğŸ“š ä»€ä¹ˆæ˜¯ Compute Shader</h2>
                    <p>Compute Shader æ˜¯è¿è¡Œåœ¨ GPU ä¸Šçš„é€šç”¨è®¡ç®—ç¨‹åºï¼Œä¸ç»‘å®šåˆ°æ¸²æŸ“ç®¡çº¿ï¼Œå¯ä»¥è¿›è¡Œä»»æ„å¹¶è¡Œè®¡ç®—ã€‚</p>
                    
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h3">âš¡ å¹¶è¡Œè®¡ç®—</h3>
                            <p>æ•°åƒä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œ</p>
                        </div>
                        
                        <div class="feature-card">
                            <h3">ğŸ”“ çµæ´»è®¿é—®</h3>
                            <p>å¯è¯»å†™ä»»æ„ Buffer/Texture</p>
                        </div>
                        
                        <div class="feature-card">
                            <h3">ğŸ“Š æ•°æ®å¤„ç†</h3>
                            <p>ç²’å­ã€ç‰©ç†ã€AI ç­‰</p>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2">ğŸ’» åŸºç¡€ç»“æ„</h2>
                    
                    <h3">Compute Shader æ–‡ä»¶ (.compute)</h3>
                    <pre class="shader-code">// MyComputeShader.compute
#pragma kernel CSMain

// è¾“å…¥/è¾“å‡ºç¼“å†²
RWTexture2D<float4> Result;
float _Time;

// çº¿ç¨‹ç»„å¤§å° [numthreads(x, y, z)]
[numthreads(8, 8, 1)]
void CSMain(uint3 id : SV_DispatchThreadID)
{
    // id.xy æ˜¯å½“å‰çº¿ç¨‹å¤„ç†çš„åƒç´ åæ ‡
    float2 uv = id.xy / 512.0;
    
    // è®¡ç®—é¢œè‰²
    float r = sin(uv.x * 10 + _Time) * 0.5 + 0.5;
    float g = cos(uv.y * 10 + _Time) * 0.5 + 0.5;
    
    // å†™å…¥ç»“æœ
    Result[id.xy] = float4(r, g, 0.5, 1);
}</pre>

                    <h3">C# è°ƒç”¨ä»£ç </h3>
                    <pre class="shader-code">using UnityEngine;

public class ComputeShaderExample : MonoBehaviour
{
    public ComputeShader computeShader;
    public RenderTexture resultTexture;
    
    void Start()
    {
        // åˆ›å»º RenderTexture
        resultTexture = new RenderTexture(512, 512, 0);
        resultTexture.enableRandomWrite = true;  // é‡è¦ï¼
        resultTexture.Create();
    }
    
    void Update()
    {
        // æ‰¾åˆ° kernel
        int kernel = computeShader.FindKernel("CSMain");
        
        // è®¾ç½®å‚æ•°
        computeShader.SetTexture(kernel, "Result", resultTexture);
        computeShader.SetFloat("_Time", Time.time);
        
        // æ´¾å‘è®¡ç®—
        // 512 / 8 = 64 ä¸ªçº¿ç¨‹ç»„
        computeShader.Dispatch(kernel, 512 / 8, 512 / 8, 1);
    }
}</pre>
                </div>

                <div class="section">
                    <h2">ğŸ”¢ çº¿ç¨‹æ¨¡å‹</h2>
                    
                    <div class="term-card">
                        <h3">çº¿ç¨‹ç»„ (Thread Group)</h3>
                        <div class="term-details">
                            <p><code>[numthreads(8, 8, 1)]</code> å®šä¹‰æ¯ä¸ªçº¿ç¨‹ç»„çš„å¤§å°</p>
                            <p><code>Dispatch(64, 64, 1)</code> å®šä¹‰çº¿ç¨‹ç»„æ•°é‡</p>
                            <p><strong>æ€»çº¿ç¨‹æ•°ï¼š</strong>8Ã—8Ã—1 Ã— 64Ã—64Ã—1 = 262,144</p>
                        </div>
                    </div>
                    
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>è¯­ä¹‰</th>
                                <th>è¯´æ˜</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>SV_GroupID</code></td>
                                <td>çº¿ç¨‹ç»„ ID</td>
                            </tr>
                            <tr>
                                <td><code>SV_GroupThreadID</code></td>
                                <td>ç»„å†…çº¿ç¨‹ ID</td>
                            </tr>
                            <tr>
                                <td><code>SV_DispatchThreadID</code></td>
                                <td>å…¨å±€çº¿ç¨‹ IDï¼ˆæœ€å¸¸ç”¨ï¼‰</td>
                            </tr>
                            <tr>
                                <td><code>SV_GroupIndex</code></td>
                                <td>ç»„å†…çº¿ç¨‹ä¸€ç»´ç´¢å¼•</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="section">
                    <h2">ğŸ® å¸¸è§åº”ç”¨</h2>
                    
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h3">ğŸŒŠ GPU ç²’å­</h3>
                            <p>å¤§é‡ç²’å­çš„ä½ç½®æ›´æ–°</p>
                        </div>
                        
                        <div class="feature-card">
                            <h3">ğŸ–¼ï¸ å›¾åƒå¤„ç†</h3>
                            <p>æ¨¡ç³Šã€è¾¹ç¼˜æ£€æµ‹ç­‰</p>
                        </div>
                        
                        <div class="feature-card">
                            <h3">ğŸŒ¿ è‰åœ°/æ¯›å‘</h3>
                            <p>ç¨‹åºåŒ–ç”Ÿæˆå’ŒåŠ¨ç”»</p>
                        </div>
                        
                        <div class="feature-card">
                            <h3">ğŸ§  AI/æ¨¡æ‹Ÿ</h3>
                            <p>ç¥ç»ç½‘ç»œã€ç‰©ç†æ¨¡æ‹Ÿ</p>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2">âš ï¸ æ³¨æ„äº‹é¡¹</h2>
                    
                    <div class="warning-box">
                        <h4">å¹³å°æ”¯æŒ</h4>
                        <p>éƒ¨åˆ†æ—§è®¾å¤‡ä¸æ”¯æŒ Compute Shaderã€‚ä½¿ç”¨å‰æ£€æŸ¥ <code>SystemInfo.supportsComputeShaders</code></p>
                    </div>
                    
                    <div class="warning-box">
                        <h4">çº¿ç¨‹åŒæ­¥</h4>
                        <p>ç»„å†…çº¿ç¨‹å¯ç”¨ <code>GroupMemoryBarrierWithGroupSync()</code> åŒæ­¥ï¼Œè·¨ç»„éœ€è¦å¤šæ¬¡ Dispatchã€‚</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="../js/sidebar.js"></script>
    <script src="../js/shader-highlight.js"></script>
    <script src="../js/app.js"></script>
</body>
</html>
