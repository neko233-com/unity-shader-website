<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆ‡çº¿ç©ºé—´ - Unity URP 2022 LTS æ•™ç¨‹</title>
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1>URP æ•™ç¨‹</h1>
            </div>
            <nav class="nav-menu" id="navMenu">
                <div class="nav-section">
                    <h3>ğŸ“ åæ ‡ç©ºé—´</h3>
                    <ul>
                        <li><a href="coordinate-spaces.html">åæ ‡ç©ºé—´æ¦‚è¿°</a></li>
                        <li><a href="object-space.html">ç‰©ä½“ç©ºé—´</a></li>
                        <li><a href="world-space.html">ä¸–ç•Œç©ºé—´</a></li>
                        <li><a href="view-space.html">è§‚å¯Ÿç©ºé—´</a></li>
                        <li><a href="clip-space.html">è£å‰ªç©ºé—´</a></li>
                        <li><a href="screen-space.html">å±å¹•ç©ºé—´</a></li>
                        <li><a href="tangent-space.html" class="active">åˆ‡çº¿ç©ºé—´</a></li>
                    </ul>
                </div>
            </nav>
        </aside>

        <main class="main-content">
            <div class="function-page">
                <h1>åˆ‡çº¿ç©ºé—´ (Tangent Space)</h1>
                <p class="subtitle">æ³•çº¿è´´å›¾ä½¿ç”¨çš„å±€éƒ¨åæ ‡ç³»ç»Ÿ</p>

                <div class="section">
                    <h2>ğŸ“š å®šä¹‰</h2>
                    <p>åˆ‡çº¿ç©ºé—´æ˜¯å®šä¹‰åœ¨æ¯ä¸ªé¡¶ç‚¹ä¸Šçš„å±€éƒ¨åæ ‡ç³»ï¼Œç”±åˆ‡çº¿(T)ã€å‰¯åˆ‡çº¿(B)ã€æ³•çº¿(N)ä¸‰ä¸ªè½´æ„æˆï¼Œä¹Ÿç§°ä¸º TBN ç©ºé—´ã€‚</p>
                    
                    <div class="diagram-container">
                        <svg viewBox="0 0 300 250" class="tbn-diagram">
                            <!-- è¡¨é¢ -->
                            <ellipse cx="150" cy="180" rx="100" ry="30" fill="none" stroke="#555" stroke-width="2"/>
                            
                            <!-- TBN è½´ -->
                            <line x1="150" y1="180" x2="150" y2="60" stroke="#00ff88" stroke-width="3" marker-end="url(#tbnN)"/>
                            <line x1="150" y1="180" x2="250" y2="160" stroke="#ff4444" stroke-width="3" marker-end="url(#tbnT)"/>
                            <line x1="150" y1="180" x2="80" y2="130" stroke="#4a9eff" stroke-width="3" marker-end="url(#tbnB)"/>
                            
                            <!-- æ ‡ç­¾ -->
                            <text x="160" y="55" fill="#00ff88" font-size="14">N (æ³•çº¿)</text>
                            <text x="255" y="165" fill="#ff4444" font-size="14">T (åˆ‡çº¿)</text>
                            <text x="30" y="125" fill="#4a9eff" font-size="14">B (å‰¯åˆ‡çº¿)</text>
                            
                            <!-- UV æ–¹å‘ç¤ºæ„ -->
                            <text x="200" y="200" fill="#888" font-size="10">â†’ U</text>
                            <text x="70" y="175" fill="#888" font-size="10">â†’ V</text>
                            
                            <defs>
                                <marker id="tbnN" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#00ff88"/>
                                </marker>
                                <marker id="tbnT" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#ff4444"/>
                                </marker>
                                <marker id="tbnB" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#4a9eff"/>
                                </marker>
                            </defs>
                        </svg>
                    </div>
                </div>

                <div class="section">
                    <h2">ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦åˆ‡çº¿ç©ºé—´</h2>
                    
                    <div class="term-card">
                        <h3>æ³•çº¿è´´å›¾å­˜å‚¨</h3>
                        <div class="term-details">
                            <p>æ³•çº¿è´´å›¾ä¸­çš„æ³•çº¿æ˜¯ç›¸å¯¹äºè¡¨é¢å­˜å‚¨çš„ï¼Œè€Œä¸æ˜¯ä¸–ç•Œç©ºé—´ã€‚è¿™æ ·åŒä¸€å¼ æ³•çº¿è´´å›¾å¯ä»¥åº”ç”¨åˆ°ä»»ä½•æœå‘çš„è¡¨é¢ã€‚</p>
                            <ul>
                                <li><strong>è“è‰²é€šé“ï¼š</strong>Z åˆ†é‡ï¼Œæœå‘è¡¨é¢å¤–ï¼ˆé€šå¸¸æ¥è¿‘1ï¼‰</li>
                                <li><strong>çº¢è‰²é€šé“ï¼š</strong>X åˆ†é‡ï¼Œæ²¿åˆ‡çº¿æ–¹å‘</li>
                                <li><strong>ç»¿è‰²é€šé“ï¼š</strong>Y åˆ†é‡ï¼Œæ²¿å‰¯åˆ‡çº¿æ–¹å‘</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2>ğŸ’» åœ¨ Shader ä¸­ä½¿ç”¨</h2>
                    
                    <pre class="shader-code">// é¡¶ç‚¹ç€è‰²å™¨ - æ„å»º TBN çŸ©é˜µ
Varyings vert(Attributes input)
{
    Varyings output;
    
    // å˜æ¢åˆ°ä¸–ç•Œç©ºé—´
    output.normalWS = TransformObjectToWorldNormal(input.normalOS);
    output.tangentWS = TransformObjectToWorldDir(input.tangentOS.xyz);
    
    // è®¡ç®—å‰¯åˆ‡çº¿ï¼ˆä½¿ç”¨åˆ‡çº¿çš„ w åˆ†é‡å†³å®šæ–¹å‘ï¼‰
    float sign = input.tangentOS.w * GetOddNegativeScale();
    output.bitangentWS = cross(output.normalWS, output.tangentWS) * sign;
    
    return output;
}

// ç‰‡æ®µç€è‰²å™¨ - é‡‡æ ·æ³•çº¿è´´å›¾
half4 frag(Varyings input) : SV_Target
{
    // é‡‡æ ·æ³•çº¿è´´å›¾ï¼ˆåˆ‡çº¿ç©ºé—´ï¼‰
    half4 normalMap = SAMPLE_TEXTURE2D(_BumpMap, sampler_BumpMap, input.uv);
    half3 normalTS = UnpackNormal(normalMap);
    
    // æ„å»º TBN çŸ©é˜µ
    half3x3 TBN = half3x3(
        input.tangentWS,
        input.bitangentWS,
        input.normalWS
    );
    
    // åˆ‡çº¿ç©ºé—´ â†’ ä¸–ç•Œç©ºé—´
    half3 normalWS = TransformTangentToWorld(normalTS, TBN);
    normalWS = normalize(normalWS);
    
    // ä½¿ç”¨ä¸–ç•Œç©ºé—´æ³•çº¿è¿›è¡Œå…‰ç…§è®¡ç®—...
}</pre>
                </div>

                <div class="section">
                    <h2">ğŸ”§ URP è¾…åŠ©å‡½æ•°</h2>
                    
                    <pre class="shader-code">// URP æä¾›çš„ä¾¿æ·å‡½æ•°
#include "Packages/com.unity.render-pipelines.universal/ShaderLibrary/Core.hlsl"

// è§£åŒ…æ³•çº¿
half3 normalTS = UnpackNormal(normalMapSample);

// å¸¦å¼ºåº¦è°ƒèŠ‚
half3 normalTS = UnpackNormalScale(normalMapSample, _BumpScale);

// å˜æ¢åˆ°ä¸–ç•Œç©ºé—´
half3 normalWS = TransformTangentToWorld(normalTS, 
    half3x3(tangentWS, bitangentWS, vertexNormalWS));</pre>
                </div>

                <div class="section">
                    <h2">ğŸ® åº”ç”¨åœºæ™¯</h2>
                    
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h3">ğŸ—ºï¸ æ³•çº¿è´´å›¾</h3>
                            <p>å¢åŠ è¡¨é¢ç»†èŠ‚è€Œä¸å¢åŠ å‡ ä½•å¤æ‚åº¦</p>
                        </div>
                        
                        <div class="feature-card">
                            <h3">ğŸŒŠ æ°´é¢æ³¢çº¹</h3>
                            <p>åŠ¨æ€æ³•çº¿äº§ç”Ÿæ³¢çº¹æ•ˆæœ</p>
                        </div>
                        
                        <div class="feature-card">
                            <h3">ğŸ“¦ è§†å·®è´´å›¾</h3>
                            <p>æ¨¡æ‹Ÿæ·±åº¦çš„é«˜åº¦å›¾æ•ˆæœ</p>
                        </div>
                    </div>
                </div>

                <div class="nav-links">
                    <a href="screen-space.html">â† å±å¹•ç©ºé—´</a>
                    <a href="mvp-matrix.html">MVP çŸ©é˜µ â†’</a>
                </div>
            </div>
        </main>
    </div>

    <script src="../js/sidebar.js"></script>
    <script src="../js/shader-highlight.js"></script>
    <script src="../js/app.js"></script>
</body>
</html>
