<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å±å¹•ç©ºé—´ - Unity URP 2022 LTS æ•™ç¨‹</title>
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1>URP æ•™ç¨‹</h1>
            </div>
            <nav class="nav-menu" id="navMenu">
                <div class="nav-section">
                    <h3>ğŸ“ åæ ‡ç©ºé—´</h3>
                    <ul>
                        <li><a href="coordinate-spaces.html">åæ ‡ç©ºé—´æ¦‚è¿°</a></li>
                        <li><a href="object-space.html">ç‰©ä½“ç©ºé—´</a></li>
                        <li><a href="world-space.html">ä¸–ç•Œç©ºé—´</a></li>
                        <li><a href="view-space.html">è§‚å¯Ÿç©ºé—´</a></li>
                        <li><a href="clip-space.html">è£å‰ªç©ºé—´</a></li>
                        <li><a href="screen-space.html" class="active">å±å¹•ç©ºé—´</a></li>
                        <li><a href="tangent-space.html">åˆ‡çº¿ç©ºé—´</a></li>
                    </ul>
                </div>
            </nav>
        </aside>

        <main class="main-content">
            <div class="function-page">
                <h1>å±å¹•ç©ºé—´ (Screen Space)</h1>
                <p class="subtitle">æœ€ç»ˆæ¸²æŸ“åˆ°å±å¹•çš„ 2D åæ ‡</p>

                <div class="section">
                    <h2>ğŸ“š å®šä¹‰</h2>
                    <p>å±å¹•ç©ºé—´æ˜¯ 2D åæ ‡ç³»ç»Ÿï¼Œè¡¨ç¤ºåƒç´ åœ¨å±å¹•ä¸Šçš„ä½ç½®ã€‚åŸç‚¹é€šå¸¸åœ¨å·¦ä¸‹è§’ï¼ˆOpenGLï¼‰æˆ–å·¦ä¸Šè§’ï¼ˆDirectXï¼‰ã€‚</p>
                    
                    <div class="diagram-container">
                        <svg viewBox="0 0 300 220" class="screen-diagram">
                            <!-- å±å¹•è¾¹æ¡† -->
                            <rect x="50" y="30" width="200" height="150" fill="#1a1a2e" stroke="#4a9eff" stroke-width="2"/>
                            
                            <!-- åæ ‡è½´ -->
                            <line x1="50" y1="180" x2="50" y2="30" stroke="#00ff88" stroke-width="2" marker-end="url(#scrArrowG)"/>
                            <line x1="50" y1="180" x2="250" y2="180" stroke="#ff4444" stroke-width="2" marker-end="url(#scrArrowR)"/>
                            
                            <!-- æ ‡ç­¾ -->
                            <text x="30" y="30" fill="#00ff88" font-size="11">Y</text>
                            <text x="255" y="185" fill="#ff4444" font-size="11">X</text>
                            
                            <!-- åæ ‡ç‚¹ -->
                            <circle cx="50" cy="180" r="4" fill="#fff"/>
                            <text x="20" y="200" fill="#ccc" font-size="10">(0,0)</text>
                            
                            <circle cx="250" cy="30" r="4" fill="#fff"/>
                            <text x="220" y="25" fill="#ccc" font-size="10">(W,H)</text>
                            
                            <!-- åƒç´ ç¤ºæ„ -->
                            <rect x="120" y="100" width="10" height="10" fill="#ff8844"/>
                            <text x="135" y="110" fill="#ff8844" font-size="9">(x,y)</text>
                            
                            <defs>
                                <marker id="scrArrowG" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#00ff88"/>
                                </marker>
                                <marker id="scrArrowR" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                    <polygon points="0 0, 10 3.5, 0 7" fill="#ff4444"/>
                                </marker>
                            </defs>
                        </svg>
                    </div>
                </div>

                <div class="section">
                    <h2>ğŸ’» åœ¨ Shader ä¸­ä½¿ç”¨</h2>
                    
                    <h3>è·å–å±å¹•åæ ‡</h3>
                    <pre class="shader-code">// æ–¹æ³•1: ä½¿ç”¨ ComputeScreenPosï¼ˆé¡¶ç‚¹ç€è‰²å™¨ï¼‰
Varyings vert(Attributes input)
{
    Varyings output;
    output.positionCS = TransformObjectToHClip(input.positionOS.xyz);
    output.screenPos = ComputeScreenPos(output.positionCS);
    return output;
}

// ç‰‡æ®µç€è‰²å™¨ä¸­é€è§†é™¤æ³•
half4 frag(Varyings input) : SV_Target
{
    float2 screenUV = input.screenPos.xy / input.screenPos.w;
    // screenUV èŒƒå›´: [0, 1]
}

// æ–¹æ³•2: ç›´æ¥ä½¿ç”¨ positionCSï¼ˆç‰‡æ®µç€è‰²å™¨ï¼‰
half4 frag(Varyings input) : SV_Target
{
    // positionCS.xy æ˜¯åƒç´ åæ ‡
    float2 pixelPos = input.positionCS.xy;
    
    // è½¬æ¢ä¸ºUV (éœ€è¦å±å¹•å°ºå¯¸)
    float2 screenUV = pixelPos / _ScreenParams.xy;
}</pre>

                    <h3>å¸¸ç”¨å†…ç½®å˜é‡</h3>
                    <pre class="shader-code">// _ScreenParams
// x = å±å¹•å®½åº¦ï¼ˆåƒç´ ï¼‰
// y = å±å¹•é«˜åº¦ï¼ˆåƒç´ ï¼‰
// z = 1 + 1/å®½åº¦
// w = 1 + 1/é«˜åº¦

float2 screenSize = _ScreenParams.xy;
float aspectRatio = _ScreenParams.x / _ScreenParams.y;</pre>
                </div>

                <div class="section">
                    <h2>ğŸ® åº”ç”¨åœºæ™¯</h2>
                    
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h3>ğŸ–¼ï¸ åå¤„ç†</h3>
                            <p>å…¨å±æ•ˆæœåŸºäºå±å¹•UV</p>
                            <pre class="shader-code">half4 color = SAMPLE_TEXTURE2D(_MainTex, sampler_MainTex, screenUV);</pre>
                        </div>
                        
                        <div class="feature-card">
                            <h3">ğŸŒŠ æ‰­æ›²æ•ˆæœ</h3>
                            <p>é‡‡æ · OpaqueTexture</p>
                        </div>
                        
                        <div class="feature-card">
                            <h3">ğŸ“º æ‰«æçº¿</h3>
                            <p>CRT æ˜¾ç¤ºå™¨æ•ˆæœ</p>
                            <pre class="shader-code">float scanline = sin(screenUV.y * 800) * 0.1;</pre>
                        </div>
                        
                        <div class="feature-card">
                            <h3">ğŸ¯ å±å¹•ç©ºé—´åå°„</h3>
                            <p>SSR åœ¨å±å¹•ç©ºé—´è¿½è¸ª</p>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2">âš ï¸ å¹³å°å·®å¼‚</h2>
                    
                    <div class="warning-box">
                        <h4>Y è½´ç¿»è½¬</h4>
                        <p>ä¸åŒå¹³å° Y è½´æ–¹å‘å¯èƒ½ä¸åŒã€‚ä½¿ç”¨ <code>_ProjectionParams.x</code> åˆ¤æ–­ï¼š</p>
                        <pre class="shader-code">// _ProjectionParams.x: 1 æ­£å¸¸ï¼Œ-1 ç¿»è½¬
#if UNITY_UV_STARTS_AT_TOP
    if (_ProjectionParams.x < 0)
        screenUV.y = 1 - screenUV.y;
#endif</pre>
                    </div>
                </div>

                <div class="nav-links">
                    <a href="clip-space.html">â† è£å‰ªç©ºé—´</a>
                    <a href="tangent-space.html">åˆ‡çº¿ç©ºé—´ â†’</a>
                </div>
            </div>
        </main>
    </div>

    <script src="../js/sidebar.js"></script>
    <script src="../js/shader-highlight.js"></script>
    <script src="../js/app.js"></script>
</body>
</html>
