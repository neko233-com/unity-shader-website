<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PBR å…‰ç…§ - Unity URP 2022 LTS æ•™ç¨‹</title>
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1>URP æ•™ç¨‹</h1>
            </div>
            <nav class="nav-menu" id="navMenu">
                <div class="nav-section">
                    <h3>ğŸ’¡ å…‰ç…§ç³»ç»Ÿ</h3>
                    <ul>
                        <li><a href="lighting-overview.html">å…‰ç…§æ¦‚è¿°</a></li>
                        <li><a href="lambert.html">Lambert æ¼«åå°„</a></li>
                        <li><a href="phong.html">Phong é«˜å…‰</a></li>
                        <li><a href="blinn-phong.html">Blinn-Phong</a></li>
                        <li><a href="pbr-lighting.html" class="active">PBR å…‰ç…§</a></li>
                    </ul>
                </div>
            </nav>
        </aside>

        <main class="main-content">
            <div class="function-page">
                <h1>PBR å…‰ç…§ (Physically Based Rendering)</h1>
                <p class="subtitle">ç‰©ç†çœŸå®çš„ç°ä»£æ¸²æŸ“æŠ€æœ¯</p>

                <div class="section">
                    <h2>ğŸ“š ä»€ä¹ˆæ˜¯ PBR</h2>
                    <p>PBRï¼ˆåŸºäºç‰©ç†çš„æ¸²æŸ“ï¼‰æ˜¯ä¸€å¥—éµå¾ªç‰©ç†è§„å¾‹çš„æ¸²æŸ“æ–¹æ³•ï¼Œèƒ½åœ¨å„ç§å…‰ç…§ç¯å¢ƒä¸‹äº§ç”Ÿä¸€è‡´ä¸”çœŸå®çš„è§†è§‰æ•ˆæœã€‚</p>
                    
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h3>âš¡ èƒ½é‡å®ˆæ’</h3>
                            <p>åå°„å…‰èƒ½é‡ä¸è¶…è¿‡å…¥å°„å…‰</p>
                        </div>
                        
                        <div class="feature-card">
                            <h3>ğŸ”¬ å¾®è¡¨é¢æ¨¡å‹</h3>
                            <p>ç”¨å¾®å°é•œé¢æ¨¡æ‹Ÿç²—ç³™åº¦</p>
                        </div>
                        
                        <div class="feature-card">
                            <h3>ğŸŒˆ è²æ¶…å°”æ•ˆåº”</h3>
                            <p>è¾¹ç¼˜åå°„ç‡å¢åŠ </p>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2>ğŸ¨ æ ¸å¿ƒå‚æ•°</h2>
                    
                    <div class="term-card">
                        <h3>é‡‘å±åº¦ (Metallic)</h3>
                        <div class="term-details">
                            <p><strong>èŒƒå›´ï¼š</strong>0 - 1</p>
                            <p><strong>éé‡‘å± (0)ï¼š</strong>æ¼«åå°„ä¸ºä¸»ï¼ŒF0 â‰ˆ 0.04</p>
                            <p><strong>é‡‘å± (1)ï¼š</strong>çº¯é•œé¢åå°„ï¼ŒF0 = Albedo</p>
                        </div>
                    </div>
                    
                    <div class="term-card">
                        <h3>ç²—ç³™åº¦ (Roughness) / å…‰æ»‘åº¦ (Smoothness)</h3>
                        <div class="term-details">
                            <p><strong>å…³ç³»ï¼š</strong>Roughness = 1 - Smoothness</p>
                            <p><strong>ç²—ç³™ (1)ï¼š</strong>é«˜å…‰å®½æ³›ï¼Œè¡¨é¢æ— å…‰æ³½</p>
                            <p><strong>å…‰æ»‘ (0)ï¼š</strong>é«˜å…‰é”åˆ©ï¼Œé•œé¢æ•ˆæœ</p>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2>ğŸ§® BRDF å…¬å¼</h2>
                    
                    <div class="diagram-container">
                        <svg viewBox="0 0 500 180" class="brdf-diagram">
                            <text x="250" y="30" text-anchor="middle" fill="#fff" font-size="14">BRDF = kD Ã— fDiffuse + kS Ã— fSpecular</text>
                            
                            <rect x="50" y="60" width="180" height="100" fill="#1a1a2e" stroke="#4a9eff" rx="5"/>
                            <text x="140" y="85" text-anchor="middle" fill="#4a9eff" font-size="12">æ¼«åå°„é¡¹</text>
                            <text x="140" y="110" text-anchor="middle" fill="#ccc" font-size="11">fDiffuse = albedo / Ï€</text>
                            <text x="140" y="135" text-anchor="middle" fill="#888" font-size="10">Lambert (ç®€åŒ–)</text>
                            
                            <rect x="270" y="60" width="180" height="100" fill="#1a1a2e" stroke="#00ff88" rx="5"/>
                            <text x="360" y="85" text-anchor="middle" fill="#00ff88" font-size="12">é•œé¢åå°„é¡¹</text>
                            <text x="360" y="110" text-anchor="middle" fill="#ccc" font-size="11">D Ã— F Ã— G</text>
                            <text x="360" y="135" text-anchor="middle" fill="#888" font-size="10">Cook-Torrance</text>
                        </svg>
                    </div>
                    
                    <h3>é•œé¢åå°„ä¸‰è¦ç´ </h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h3>D - æ³•çº¿åˆ†å¸ƒ</h3>
                            <p>å¾®è¡¨é¢æ³•çº¿çš„ç»Ÿè®¡åˆ†å¸ƒ</p>
                            <p><small>å¸¸ç”¨: GGX / Trowbridge-Reitz</small></p>
                        </div>
                        
                        <div class="feature-card">
                            <h3>F - è²æ¶…å°”</h3>
                            <p>åå°„ç‡éšè§’åº¦å˜åŒ–</p>
                            <p><small>å¸¸ç”¨: Schlick è¿‘ä¼¼</small></p>
                        </div>
                        
                        <div class="feature-card">
                            <h3>G - å‡ ä½•é®è”½</h3>
                            <p>å¾®è¡¨é¢è‡ªé®æŒ¡</p>
                            <p><small>å¸¸ç”¨: Smith-GGX</small></p>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2>ğŸ’» URP å®ç°</h2>
                    
                    <pre class="shader-code">// URP å†…ç½® PBR å‡½æ•°
#include "Packages/com.unity.render-pipelines.universal/ShaderLibrary/Lighting.hlsl"

half4 frag(Varyings input) : SV_Target
{
    // å‡†å¤‡è¡¨é¢æ•°æ®
    SurfaceData surfaceData;
    surfaceData.albedo = _BaseColor.rgb;
    surfaceData.metallic = _Metallic;
    surfaceData.smoothness = _Smoothness;
    surfaceData.normalTS = UnpackNormal(SAMPLE_TEXTURE2D(_BumpMap, sampler_BumpMap, input.uv));
    surfaceData.occlusion = 1.0;
    surfaceData.emission = 0;
    surfaceData.alpha = _BaseColor.a;
    
    // å‡†å¤‡è¾“å…¥æ•°æ®
    InputData inputData;
    inputData.positionWS = input.positionWS;
    inputData.normalWS = TransformTangentToWorld(surfaceData.normalTS, 
        half3x3(input.tangentWS, input.bitangentWS, input.normalWS));
    inputData.viewDirectionWS = GetWorldSpaceNormalizeViewDir(input.positionWS);
    inputData.shadowCoord = TransformWorldToShadowCoord(input.positionWS);
    
    // è®¡ç®— PBR å…‰ç…§
    half4 color = UniversalFragmentPBR(inputData, surfaceData);
    
    return color;
}</pre>
                </div>

                <div class="section">
                    <h2>ğŸ¯ ç®€åŒ–ç‰ˆ PBR</h2>
                    
                    <pre class="shader-code">// ç®€åŒ–çš„ PBR å®ç°
half3 SimplePBR(half3 albedo, half metallic, half roughness,
                half3 N, half3 V, half3 L, half3 lightColor)
{
    half3 H = normalize(L + V);
    half NdotL = saturate(dot(N, L));
    half NdotV = saturate(dot(N, V));
    half NdotH = saturate(dot(N, H));
    half VdotH = saturate(dot(V, H));
    
    // é‡‘å±åº¦å½±å“ F0
    half3 F0 = lerp(0.04, albedo, metallic);
    
    // è²æ¶…å°” (Schlick)
    half3 F = F0 + (1.0 - F0) * pow(1.0 - VdotH, 5.0);
    
    // æ³•çº¿åˆ†å¸ƒ (GGX)
    half a = roughness * roughness;
    half a2 = a * a;
    half d = NdotH * NdotH * (a2 - 1.0) + 1.0;
    half D = a2 / (PI * d * d);
    
    // å‡ ä½•é®è”½ (ç®€åŒ–)
    half k = roughness * 0.5;
    half G = NdotL * NdotV / ((NdotL * (1.0 - k) + k) * (NdotV * (1.0 - k) + k));
    
    // é•œé¢åå°„
    half3 specular = D * F * G / (4.0 * NdotL * NdotV + 0.001);
    
    // æ¼«åå°„ï¼ˆé‡‘å±æ²¡æœ‰æ¼«åå°„ï¼‰
    half3 kD = (1.0 - F) * (1.0 - metallic);
    half3 diffuse = kD * albedo / PI;
    
    return (diffuse + specular) * lightColor * NdotL;
}</pre>
                </div>

                <div class="section">
                    <h2>âš ï¸ å¸¸è§é—®é¢˜</h2>
                    
                    <div class="warning-box">
                        <h4>é‡‘å±åº¦è´´å›¾</h4>
                        <p>é‡‘å±åº¦é€šå¸¸åªæœ‰ 0 æˆ– 1ï¼Œä¸­é—´å€¼ç”¨äºè¿‡æ¸¡åŒºåŸŸï¼ˆå¦‚ç”Ÿé”ˆé‡‘å±ï¼‰ã€‚ä¸è¦ç”¨ç°åº¦å€¼è¡¨ç¤º"åŠé‡‘å±"ã€‚</p>
                    </div>
                    
                    <div class="warning-box">
                        <h4>Albedo äº®åº¦</h4>
                        <p>éé‡‘å± Albedo å€¼åº”åœ¨ 50-240 (sRGB) èŒƒå›´å†…ã€‚è¿‡æš—æˆ–è¿‡äº®éƒ½ä¸ç¬¦åˆç‰©ç†ã€‚</p>
                    </div>
                </div>

                <div class="nav-links">
                    <a href="blinn-phong.html">â† Blinn-Phong</a>
                    <a href="fresnel.html">è²æ¶…å°”æ•ˆæœ â†’</a>
                </div>
            </div>
        </main>
    </div>

    <script src="../js/sidebar.js"></script>
    <script src="../js/shader-highlight.js"></script>
    <script src="../js/app.js"></script>
</body>
</html>
